{{ define "title" }}{{ .Title }} - {{ .Site.Title }}{{ end }}

{{ define "main" }}
<div class="container mx-auto px-4 py-8">
    <!-- Page header -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-serif font-bold text-gray-800 mb-4">{{ .Title }}</h1>
        <p class="text-lg text-gray-600 max-w-3xl mx-auto">
            {{ .Content }}
        </p>
    </div>

    <!-- Debug Publications -->
    <div class="max-w-4xl mx-auto mb-8 p-4 bg-gray-100 rounded text-sm">
        <strong>Debug: Publications found:</strong>
        {{ $allPubs := where .Site.Pages "Type" "publication" }}
        {{ if eq (len $allPubs) 0 }}
            <span class="text-red-600">No publications found!</span>
        {{ else }}
            {{ range $allPubs }}
                <div>{{ .Title }} ({{ .Params.date_range }}) - Type: {{ .Type }}</div>
            {{ end }}
        {{ end }}
    </div>

    <!-- Timeline -->
    <div class="relative">
        <!-- Timeline items -->
        <div class="space-y-12">
            <!-- 1845-1880: Mining Era -->
            <div class="relative flex items-start md:justify-center">
                <div class="w-full md:w-1/2 md:pr-8">
                    <div class="bg-blue-50 rounded-lg p-6 border border-blue-200">
                        <h3 class="text-xl font-serif font-bold text-blue-800 mb-2">1845-1880: Mining Era</h3>
                        <p class="text-sm text-blue-700 mb-4">The birth of Burra as a copper mining town, documented in early newspapers.</p>
                        
                        {{ $publications := where .Site.Pages "Type" "publication" }}
                        {{ range $publications }}
                        {{ if .Params.date_range }}
                        {{ $years := split .Params.date_range "-" }}
                        {{ $startYear := index $years 0 | int }}
                        {{ if and (ge $startYear 1845) (le $startYear 1880) }}
                        <div class="bg-white rounded p-3 mb-2 border border-blue-100 hover:border-blue-200 transition-colors cursor-pointer">
                            <div class="flex justify-between items-center">
                                <a href="{{ .Permalink }}" class="font-medium text-blue-800 hover:text-blue-600 hover:underline">
                                    {{ .Title }}
                                </a>
                                <span class="text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded">{{ .Params.date_range }}</span>
                            </div>
                            <div class="text-xs text-blue-600 mt-1">{{ .Params.document_count }} documents • {{ .Params.total_paragraphs | humanize }} paragraphs</div>
                        </div>
                        {{ end }}
                        {{ end }}
                        {{ end }}
                        
                        <!-- Show message if no publications in this era -->
                        {{ $eraCount := 0 }}
                        {{ range $publications }}
                        {{ if .Params.date_range }}
                        {{ $years := split .Params.date_range "-" }}
                        {{ $startYear := index $years 0 | int }}
                        {{ if and (ge $startYear 1845) (le $startYear 1880) }}
                        {{ $eraCount = add $eraCount 1 }}
                        {{ end }}
                        {{ end }}
                        {{ end }}
                        {{ if eq $eraCount 0 }}
                        <div class="text-xs text-blue-500 italic">No publications found in this era</div>
                        {{ end }}
                    </div>
                </div>
            </div>

            <!-- 1880-1950: Agricultural Era -->
            <div class="relative flex items-start md:justify-center">
                <div class="w-full md:w-1/2 md:pl-8 md:ml-1/2">
                    <div class="bg-green-50 rounded-lg p-6 border border-green-200">
                        <h3 class="text-xl font-serif font-bold text-green-800 mb-2">1880-1950: Agricultural Transition</h3>
                        <p class="text-sm text-green-700 mb-4">The evolution from mining to agriculture, recorded in local newspapers.</p>
                        
                        {{ range $publications }}
                        {{ if .Params.date_range }}
                        {{ $years := split .Params.date_range "-" }}
                        {{ $startYear := index $years 0 | int }}
                        {{ if and (ge $startYear 1880) (le $startYear 1950) }}
                        <div class="bg-white rounded p-3 mb-2 border border-green-100 hover:border-green-200 transition-colors cursor-pointer">
                            <div class="flex justify-between items-center">
                                <a href="{{ .Permalink }}" class="font-medium text-green-800 hover:text-green-600 hover:underline">
                                    {{ .Title }}
                                </a>
                                <span class="text-xs text-green-600 bg-green-50 px-2 py-1 rounded">{{ .Params.date_range }}</span>
                            </div>
                            <div class="text-xs text-green-600 mt-1">{{ .Params.document_count }} documents • {{ .Params.total_paragraphs | humanize }} paragraphs</div>
                        </div>
                        {{ end }}
                        {{ end }}
                        {{ end }}
                    </div>
                </div>
            </div>

            <!-- 1950-2016: Modern Era -->
            <div class="relative flex items-start md:justify-center">
                <div class="w-full md:w-1/2 md:pr-8">
                    <div class="bg-purple-50 rounded-lg p-6 border border-purple-200">
                        <h3 class="text-xl font-serif font-bold text-purple-800 mb-2">1950-2016: Modern Era</h3>
                        <p class="text-sm text-purple-700 mb-4">Contemporary Burra through the lens of modern journalism and community reporting.</p>
                        
                        {{ range $publications }}
                        {{ if .Params.date_range }}
                        {{ $years := split .Params.date_range "-" }}
                        {{ $startYear := index $years 0 | int }}
                        {{ if ge $startYear 1950 }}
                        <div class="bg-white rounded p-3 mb-2 border border-purple-100 hover:border-purple-200 transition-colors cursor-pointer">
                            <div class="flex justify-between items-center">
                                <a href="{{ .Permalink }}" class="font-medium text-purple-800 hover:text-purple-600 hover:underline">
                                    {{ .Title }}
                                </a>
                                <span class="text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded">{{ .Params.date_range }}</span>
                            </div>
                            <div class="text-xs text-purple-600 mt-1">{{ .Params.document_count }} documents • {{ .Params.total_paragraphs | humanize }} paragraphs</div>
                        </div>
                        {{ end }}
                        {{ end }}
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Archive Statistics -->
    <section class="bg-gradient-to-r from-amber-50 to-amber-100 rounded-lg p-8 text-center mt-16">
        <h2 class="text-2xl font-serif font-bold text-gray-800 mb-6">171 Years of History</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-3xl mx-auto">
            <div class="text-center">
                <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-3">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H9m0 0H5m0 0h2M7 16h6M7 8h6v4H7V8z"></path>
                    </svg>
                </div>
                <h3 class="font-semibold text-blue-800">Mining Heritage</h3>
                <p class="text-sm text-blue-600">1845-1880</p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-3">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"></path>
                    </svg>
                </div>
                <h3 class="font-semibold text-green-800">Agricultural Growth</h3>
                <p class="text-sm text-green-600">1880-1950</p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-3">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9.5a2.5 2.5 0 00-2.5-2.5H15"></path>
                    </svg>
                </div>
                <h3 class="font-semibold text-purple-800">Modern Community</h3>
                <p class="text-sm text-purple-600">1950-2016</p>
            </div>
        </div>
    </section>
</div>
{{ end }}